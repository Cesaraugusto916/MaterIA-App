# üß† Aula 02 ‚Äî Expandindo o Universo: Dominando os DataFrames

## üéì Ol√° de novo, explorador de dados\!

Na nossa √∫ltima aula, voc√™ conheceu a **Series**, a coluna solit√°ria e poderosa do mundo do Pandas. Se a Series √© o √°tomo fundamental, o **DataFrame** √© a mol√©cula complexa. Ele √© a evolu√ß√£o natural do seu aprendizado, a estrutura que voc√™ usar√° na maior parte do tempo para manipular dados de forma tabular, como em uma planilha.

Vamos mergulhar de cabe√ßa e construir nosso conhecimento sobre a principal ferramenta de qualquer cientista de dados ou analista de dados.

  - **Tema Central**: A estrutura de dados **`DataFrame`**
  - **Comando(s) Essencial(is)**: `pd.DataFrame()`, `.columns`, `.index`, `.shape`, `.dtypes`, `.set_index()`, `.rename()`, `.astype()`, `.values`, `.to_dict()`

-----

# üìç O DataFrame: A Planilha do Python

Se voc√™ j√° trabalhou com planilhas no Excel, no Google Sheets ou com tabelas em bancos de dados SQL, voc√™ j√° conhece a l√≥gica do **DataFrame**. Ele √©, em ess√™ncia, uma cole√ß√£o de Series, todas compartilhando o mesmo √≠ndice (os r√≥tulos das linhas). √â por isso que a nossa jornada come√ßou com a Series: para entender o DataFrame, voc√™ precisa entender o seu componente b√°sico.

Um DataFrame √© uma estrutura bidimensional (2-D) que consiste em:

  - **Colunas**: Cada coluna √© uma **Series**, com seu pr√≥prio nome e tipo de dado.
  - **√çndice**: Os r√≥tulos das linhas que organizam os dados de forma vertical.

**Por que DataFrames s√£o t√£o importantes?** Porque os dados do mundo real quase nunca s√£o unidimensionais. Eles v√™m em tabelas, com m√∫ltiplos atributos para cada observa√ß√£o. Pense em uma lista de clientes: cada cliente tem um nome, uma idade, um endere√ßo, uma data de cadastro. Cada um desses atributos seria uma coluna (uma Series) dentro de um DataFrame. Dominar o DataFrame significa ter o poder de organizar, limpar, analisar e visualizar qualquer conjunto de dados tabulares.

-----

# üìö Conte√∫do Explicado: Criando e Inspecionando sua Tabela

### 1\. Criando o `DataFrame`: As M√∫ltiplas Faces de `pd.DataFrame()`

A fun√ß√£o `pd.DataFrame()` √© a porta de entrada para a cria√ß√£o dessa estrutura. Assim como a Series, ela √© flex√≠vel e aceita diferentes tipos de dados de entrada, mas os mais comuns s√£o dicion√°rios ou listas.

A sintaxe b√°sica √© `pd.DataFrame(data, index, columns, ...)`:

  - `data`: A fonte de dados que voc√™ quer transformar em uma tabela.
  - `index`: R√≥tulos para as linhas.
  - `columns`: R√≥tulos para as colunas.

-----

#### a) A Maneira Mais Comum: Usando um Dicion√°rio de Listas

Essa √© a forma mais intuitiva e popular de criar um DataFrame a partir de dados brutos que j√° est√£o organizados por "colunas". O dicion√°rio √© perfeito para isso, pois suas chaves se tornam os nomes das colunas, e as listas se tornam os valores de cada coluna.

```python
import pandas as pd

# Os dados j√° est√£o organizados por colunas: 'nome', 'idade', 'cidade'
dados = {
    'nome': ['Ana', 'Bruno', 'Carlos'],
    'idade': [23, 35, 31],
    'cidade': ['SP', 'RJ', 'MG']
}
df = pd.DataFrame(dados)
print(df)
```

**Sa√≠da Esperada**:

```
     nome  idade cidade
0     Ana     23     SP
1   Bruno     35     RJ
2  Carlos     31     MG
```

**O que aconteceu?**
O Pandas leu o dicion√°rio e automaticamente usou as chaves (`'nome'`, `'idade'`, `'cidade'`) como nomes das colunas. Ele tamb√©m criou um √≠ndice num√©rico padr√£o (`0, 1, 2...`) para as linhas. Simples e direto.

-----

#### b) Outra Abordagem: Usando uma Lista de Dicion√°rios

Seus dados tamb√©m podem estar organizados por "linhas". Ou seja, cada dicion√°rio representa um registro (uma linha), e as chaves internas s√£o os nomes das colunas.

```python
dados = [
    {'nome': 'Ana', 'idade': 23, 'cidade': 'SP'},
    {'nome': 'Bruno', 'idade': 35, 'cidade': 'RJ'}
]
df = pd.DataFrame(dados)
```

Essa forma √© muito √∫til quando voc√™ est√° recebendo dados de uma API, por exemplo, que geralmente os entrega nesse formato.

-----

#### c) De Series a DataFrame

Lembram-se do m√©todo `.to_frame()` da aula passada? Ele serve exatamente para isso: elevar uma Series para a "dimens√£o" do DataFrame.

```python
s1 = pd.Series([10, 20, 30], name='valores')
df = s1.to_frame()
print(df)
```

**Sa√≠da**:

```
   valores
0       10
1       20
2       30
```

Note que o nome da Series (`valores`) se tornou o nome da √∫nica coluna do DataFrame. Esse √© um excelente exemplo de como os conceitos se conectam.

-----

#### d) Criando a partir do NumPy

Se voc√™ j√° possui dados em um array do NumPy, pode facilmente convert√™-lo em um DataFrame, especificando os nomes das colunas.

```python
import numpy as np
arr = np.array([[1, 2], [3, 4]])
df = pd.DataFrame(arr, columns=['A', 'B'])
```

Essa abordagem √© comum em tarefas de processamento num√©rico e machine learning, onde a manipula√ß√£o com arrays √© frequente.

-----

### 2\. Inspecionando o DataFrame: Os M√©todos Essenciais

Ap√≥s criar seu DataFrame, a primeira coisa a fazer √© conhec√™-lo. O Pandas oferece um conjunto de atributos e m√©todos que agem como um "raio-x" para sua estrutura de dados.

  - `df.shape`: Retorna uma tupla `(linhas, colunas)`. √â o "tamanho" da sua tabela.
  - `df.columns`: Exibe os nomes das colunas.
  - `df.index`: Exibe os r√≥tulos das linhas.
  - `df.dtypes`: Mostra o tipo de dado de cada coluna. **Essa √© uma das inspe√ß√µes mais importantes**, pois o tipo de dado determina quais opera√ß√µes voc√™ pode realizar. Lembre-se, o `dtype` √© o tipo da **Series** que comp√µe cada coluna.

-----

# üß™ Demonstra√ß√£o Aplicada: A An√°lise em Quatro Fases

Vamos aplicar tudo o que aprendemos em um exemplo pr√°tico. Nosso objetivo √© pegar um DataFrame de vendas, inspecion√°-lo, ajustar sua estrutura e preparar os dados para an√°lise.

```python
# 1. Fase de Cria√ß√£o: Montando nosso DataFrame de vendas
vendas = pd.DataFrame({
    'dia': ['seg', 'ter', 'qua', 'qui', 'sex'],
    'valor': [250, 300, None, 410, 380],
    'loja': ['A', 'A', 'B', 'B', 'A']
})

print("--- DataFrame Criado ---")
print(vendas)
print("\n")

# 2. Fase de Inspe√ß√£o: Conhecendo a estrutura
print("--- Inspe√ß√£o ---")
print(f"Dimens√µes (linhas, colunas): {vendas.shape}")
print(f"Colunas: {vendas.columns.tolist()}")
print("\nTipos de dados:")
print(vendas.dtypes)
print("\n")

# 3. Fase de Ajuste Estrutural: Organizando a tabela
# Usamos 'dia' como nosso √≠ndice para uma melhor organiza√ß√£o
vendas_organizadas = vendas.set_index('dia')
print("--- DataFrame com 'dia' como √≠ndice ---")
print(vendas_organizadas)

# Agora, vamos renomear a coluna 'valor' para algo mais descritivo
vendas_organizadas = vendas_organizadas.rename(columns={'valor': 'vendas_diarias'})
print("\n--- DataFrame com coluna renomeada ---")
print(vendas_organizadas)
print("\n")

# 4. Fase de Tratamento de Dados: Lidando com valores ausentes
# Lembre-se da aula anterior! Vamos usar fillna() com a m√©dia para tratar o valor ausente
media_vendas = vendas_organizadas['vendas_diarias'].mean()
vendas_organizadas['vendas_diarias'] = vendas_organizadas['vendas_diarias'].fillna(media_vendas)
print("--- DataFrame com valores ausentes tratados ---")
print(vendas_organizadas)

# Para garantir, vamos verificar o tipo da coluna 'vendas_diarias'
print("\nTipo de dado da coluna 'vendas_diarias':", vendas_organizadas['vendas_diarias'].dtype)
```

**O que aprendemos com a demonstra√ß√£o?**

  - `set_index()` √© um m√©todo poderoso para transformar uma coluna em √≠ndice.
  - `rename()` nos permite manter nossos dados claros e descritivos.
  - O tratamento de valores ausentes (`fillna()`) funciona perfeitamente em uma coluna de DataFrame (que, lembre-se, √© uma Series\!), refor√ßando a conex√£o entre as duas estruturas.

-----

# üìé Dicas e Armadilhas: Evitando Problemas Comuns

  - **Tipos de Dados s√£o Cruciais**: Sempre, sempre, **sempre** inspecione os tipos de dados com `.dtypes` ou `.info()` ap√≥s criar ou carregar um DataFrame. O Pandas √© inteligente, mas pode inferir tipos de forma inesperada, especialmente com valores ausentes. Por exemplo, uma coluna de inteiros com um `None` ser√° convertida para `float` para acomodar o valor.
  - **`.set_index()` e o Par√¢metro `inplace`**: Quando voc√™ usa `set_index()`, por padr√£o, ele retorna um novo DataFrame. Se voc√™ quiser que a altera√ß√£o ocorra no DataFrame original, use `df.set_index('coluna', inplace=True)`. Mas a boa pr√°tica √© geralmente criar uma nova vari√°vel para evitar efeitos colaterais indesejados.
  - **Convers√£o de Tipos com `.astype()`**: √Äs vezes, voc√™ precisar√° for√ßar um tipo de dado, como converter uma coluna de `string` para `int`. Use o m√©todo `.astype()`, mas seja cauteloso. Ele falhar√° se houver valores n√£o num√©ricos em uma convers√£o para `int` ou `float`.

-----

# üîÑ Transi√ß√µes e Conex√µes

  - **Vem de**: A aula anterior sobre **Series**. Lembre-se: um DataFrame √© uma cole√ß√£o de Series. A compreens√£o de uma facilita a compreens√£o da outra.
  - **Vai para**: A pr√≥xima aula, onde exploraremos a magia de **importar dados de arquivos reais**. A partir de agora, n√£o precisaremos mais criar DataFrames manualmente\! Aprenderemos a carregar arquivos CSV, Excel e outros, transformando dados brutos em DataFrames prontos para a an√°lise.

-----

# üé® Recursos Visuais e Mentais (Para Pensar)

1.  **DataFrame como uma Tabela**: Pense em um DataFrame como um diagrama de xadrez: as linhas s√£o as fileiras, as colunas s√£o as colunas, e cada c√©lula tem um valor.
2.  **Fluxo de Trabalho**: Internalize o fluxo: **Criar (ou Importar) ‚Üí Inspecionar ‚Üí Ajustar Estrutura ‚Üí Limpar/Tratar Dados ‚Üí Analisar**.
3.  **Visualiza√ß√£o**: Lembre-se que voc√™ pode visualizar um DataFrame rapidamente usando ferramentas como `df.plot()` para ter uma ideia das distribui√ß√µes dos seus dados.

-----

Voc√™ est√° construindo uma base s√≥lida para se tornar um verdadeiro mestre do Pandas. A transi√ß√£o da Series para o DataFrame √© um grande passo, e voc√™ j√° est√° no caminho certo. Na pr√≥xima aula, a aventura fica ainda mais real quando come√ßarmos a trabalhar com dados de verdade.

Pronto para importar e analisar dados do mundo real?

--- 

# üß™ Exerc√≠cios

## üß© Parte 1: Cria√ß√£o de DataFrames

1. **Crie um DataFrame com os dados abaixo, usando um dicion√°rio de listas:**

   ```python
   {
     'nome': ['Ana', 'Bruno', 'Carlos'],
     'idade': [23, 35, 31],
     'cidade': ['SP', 'RJ', 'MG']
   }
   ```

2. **Crie um DataFrame usando uma lista de dicion√°rios com os seguintes dados:**

   ```python
   [
     {'produto': 'Arroz', 'preco': 20},
     {'produto': 'Feij√£o', 'preco': 8}
   ]
   ```

3. **Crie um DataFrame a partir de um array NumPy `[[1, 2], [3, 4]]` com colunas chamadas `'A'` e `'B'`.**

4. **Transforme a Series abaixo em um DataFrame usando `.to_frame()`:**

   ```python
   pd.Series([100, 200, 300], name='valores')
   ```

5. **Crie um DataFrame com os dados de uma loja:**

   ```python
   {
     'dia': ['seg', 'ter', 'qua'],
     'vendas': [250, 300, 270],
     'loja': ['A', 'A', 'B']
   }
   ```

---

## üîç Parte 2: Inspe√ß√£o e Estrutura

6. **Exiba o n√∫mero de linhas e colunas do DataFrame usando `.shape`.**

7. **Liste os nomes das colunas com `.columns`.**

8. **Liste os √≠ndices das linhas com `.index`.**

9. **Verifique os tipos de dados de cada coluna com `.dtypes`.**

10. **Use `.values` para exibir os dados como um array NumPy.**

---

## üß± Parte 3: Ajustes Estruturais

11. **Use `.set_index('dia')` para transformar a coluna `'dia'` em √≠ndice.**

12. **Renomeie a coluna `'vendas'` para `'vendas_diarias'` usando `.rename()`.**

13. **Converta a coluna `'vendas_diarias'` para o tipo `float` usando `.astype(float)`.**

14. **Transforme o DataFrame em um dicion√°rio com `.to_dict()`.**

15. **Crie um novo DataFrame com os dados abaixo e altere o √≠ndice para `'nome'`:**

   ```python
   {
     'nome': ['Jo√£o', 'Maria'],
     'idade': [28, 22],
     'cidade': ['SP', 'RJ']
   }
   ```

---

## üßº Parte 4: Tratamento de Dados

16. **Crie um DataFrame com valores ausentes (`None`) e use `.isna()` para identificar os dados faltantes.**

17. **Use `.fillna()` para substituir os valores ausentes pela m√©dia da coluna.**

18. **Use `.dropna()` para remover linhas com valores ausentes.**

19. **Verifique se a coluna `'idade'` est√° no tipo correto (`int`). Se n√£o estiver, converta.**

20. **Crie um DataFrame com os dados abaixo e trate o valor ausente:**

   ```python
   {
     'produto': ['Arroz', 'Feij√£o', 'Macarr√£o'],
     'preco': [20, None, 12]
   }
   ```

---